[2024-10-28 21:28:49] Base skills selected:
[2024-10-28 21:28:49]   - test_simple_automated_drill: Tests automated placement and configuration of a basic coal mining setup in a factory automation system. Verifies correct positioning and connection of a burner mining drill, inserter, and transport belts to create a functional coal extraction loop. Checks that components are properly oriented and connected to enable automated coal mining and transport.
[2024-10-28 21:28:49] Combined inventory requirements: {'stone-furnace': 2, 'iron-chest': 6, 'burner-inserter': 12, 'coal': 100, 'transport-belt': 100, 'burner-mining-drill': 10}
[2024-10-28 21:28:51] Generated objective: Implement a snippet that creates an automated iron ore mining and smelting setup by placing burner mining drills, stone furnaces, inserters and transport belts in the correct configuration to extract iron ore and process it into iron plates in a continuous production line.
[2024-10-28 21:29:07] # Find nearest iron ore patch
iron_patch = get_resource_patch(Resource.IronOre, nearest(Resource.IronOre))
assert iron_patch, "No iron ore patch found nearby"

# Find nearest coal patch 
coal_patch = get_resource_patch(Resource.Coal, nearest(Resource.Coal))
assert coal_patch, "No coal patch found nearby"

# Place iron ore mining drill
iron_drill_pos = iron_patch.bounding_box.center
move_to(iron_drill_pos)
iron_drill = place_entity(Prototype.BurnerMiningDrill, Direction.DOWN, iron_drill_pos)
assert iron_drill, f"Failed to place iron ore mining drill at {iron_drill_pos}"

# Place furnace below iron drill
furnace_pos = Position(x=iron_drill.position.x, y=iron_drill.position.y + 3)
furnace = place_entity(Prototype.StoneFurnace, Direction.NORTH, furnace_pos)
assert furnace, f"Failed to place stone furnace at {furnace_pos}"

# Place inserter between drill and furnace
drill_inserter_pos = Position(x=iron_drill.position.x, y=iron_drill.position.y + 1)
drill_inserter = place_entity(Prototype.BurnerInserter, Direction.DOWN, drill_inserter_pos)
assert drill_inserter, f"Failed to place inserter at {drill_inserter_pos}"

# Place belt from drill to furnace
belt_start = iron_drill.drop_position
belt_end = furnace.input_position
belts = connect_entities(belt_start, belt_end, Prototype.TransportBelt)
assert belts, f"Failed to place transport belts from drill to furnace"

# Place coal mining drill
coal_drill_pos = coal_patch.bounding_box.center
move_to(coal_drill_pos)
coal_drill = place_entity(Prototype.BurnerMiningDrill, Direction.DOWN, coal_drill_pos)
assert coal_drill, f"Failed to place coal mining drill at {coal_drill_pos}"

# Place inserter for coal
coal_inserter_pos = Position(x=furnace.position.x - 1, y=furnace.position.y)
coal_inserter = place_entity(Prototype.BurnerInserter, Direction.LEFT, coal_inserter_pos)
assert coal_inserter, f"Failed to place coal inserter at {coal_inserter_pos}"

# Place belt from coal drill to furnace
coal_belt_start = coal_drill.drop_position
coal_belt_end = coal_inserter.pickup_position
coal_belts = connect_entities(coal_belt_start, coal_belt_end, Prototype.TransportBelt)
assert coal_belts, f"Failed to place coal transport belts"

# Place output inserter
output_inserter_pos = Position(x=furnace.position.x + 1, y=furnace.position.y)
output_inserter = place_entity(Prototype.BurnerInserter, Direction.RIGHT, output_inserter_pos)
assert output_inserter, f"Failed to place output inserter at {output_inserter_pos}"

# Verify the complete setup
entities = inspect_entities(furnace.position, radius=5)
assert entities.get_entity(Prototype.BurnerMiningDrill), "Mining drills not found"
assert entities.get_entity(Prototype.StoneFurnace), "Stone furnace not found"
assert entities.get_entity(Prototype.BurnerInserter), "Inserters not found"
assert any(e.name == "transport-belt" for e in entities.entities), "Transport belts not found"
